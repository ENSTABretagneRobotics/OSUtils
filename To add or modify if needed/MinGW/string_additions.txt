// Should be in string.h

static __inline__
size_t strnlen( const char *start, size_t maxlen )
{
  /* Determine the length of a NUL terminated string, subject
   * to a maximum permitted length constraint.
   */
  const char *stop = start;

  /* Scan at most maxlen bytes, seeking a NUL terminator;
   * note that we MUST enforce the length check, BEFORE the
   * terminator check, otherwise we could scan maxlen + 1
   * bytes, which POSIX forbids.
   */
  while( ((stop - start) < maxlen) && *stop )
    ++stop;

  /* Result is the number of non-NUL bytes actually scanned.
   */
  return stop - start;
}

char *strsep(char **stringp, const char *delim) {
    char *rv = *stringp;
    if (rv) {
        *stringp += strcspn(*stringp, delim);
        if (**stringp)
            *(*stringp)++ = '\0';
        else
            *stringp = 0; }
    return rv;
}
